/*! For license information please see module.js.LICENSE.txt */
define(["react","d3","emotion","@grafana/ui","@grafana/data"],(function(t,e,n,r,a){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=5)}([function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e){t.exports=r},function(t,e){t.exports=a},function(t,e,n){"use strict";n.r(e);var r=n(4);var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,a,o=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(t){a={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}function i(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}function s(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var l,u,c,f,p,d,m,h=n(0),x=n.n(h),y=n(2),b=n(1),g=n(3),w=function(){function t(t){var e=o(t.series,1)[0],n=e.fields,r=e.meta;r&&r.executedQueryString?(this.dataType="table",this.results=this.setTableData(n)):(this.dataType="series",this.results=this.setSeriesData(n))}return t.prototype.getResults=function(){return this.results},t.prototype.setTableData=function(t){var e=t.find((function(t){return"x"===t.name})),n=t.find((function(t){return"y"===t.name})),r=e.values.toArray().map((function(t,e){return""+t})),a=n.values.toArray();return this.setResults(r,a,this.sumYVals(a))},t.prototype.setSeriesData=function(t){var e=o(t,2),n=e[0],r=e[1],a=n.values.toArray().map((function(t,e){return"T"+(e+1)})),i=r.values.toArray();return this.setResults(a,i,this.sumYVals(i))},t.prototype.sumYVals=function(t){return t.reduce((function(t,e){return t+e}),0)},t.prototype.setResults=function(t,e,n){return this.results=e.map((function(e,n){return{x:t[n],y:e}})).sort((function(t,e){return e.y-t.y})).reduce((function(t,e,r){var o;return a(a({},t),{x:i(t.x,[e.x]),y:i(t.y,[e.y]),p:i(t.p,[((null===(o=t)||void 0===o?void 0:o.p[r-1])?t.p[r-1]:0)+100*e.y/n])})}),{x:[],y:[],p:[]}),this.results},t}(),v=Object(g.stylesFactory)((function(){return{wrapper:Object(y.css)(u||(u=s(["\n      position: relative;\n    "],["\n      position: relative;\n    "]))),svg:Object(y.css)(c||(c=s(["\n      position: absolute;\n      top: 0;\n      left: 0;\n    "],["\n      position: absolute;\n      top: 0;\n      left: 0;\n    "]))),textBox:Object(y.css)(f||(f=s(["\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      padding: 10px;\n    "],["\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      padding: 10px;\n    "]))),line:Object(y.css)(p||(p=s(["\n      fill: none;\n      stroke: white;\n      stroke-width: 2px;\n    "],["\n      fill: none;\n      stroke: white;\n      stroke-width: 2px;\n    "]))),lineCutOff:Object(y.css)(d||(d=s(["\n      fill: none;\n      stroke: rgba(255, 0, 0, 0.75);\n      stroke-width: 2px;\n      stroke-dasharray: 5px;\n    "],["\n      fill: none;\n      stroke: rgba(255, 0, 0, 0.75);\n      stroke-width: 2px;\n      stroke-dasharray: 5px;\n    "]))),paths:Object(y.css)(m||(m=s(["\n      position: relative;\n    "],["\n      position: relative;\n    "])))}}));n.d(e,"plugin",(function(){return O}));var O=new r.PanelPlugin((function(t){var e=t.options,n=t.data,r=t.width,a=t.height,o=Object(g.useTheme)(),i=v(),u=e.vitalBreakpointVal,c=e.showVitalFew,f=e.showBottomAxis,p=new w(n).getResults(),d=b.max(p.y)||0,m=b.min(p.y)||0,h=a-40,O=r-40,j=b.scaleBand().rangeRound([0,O]).padding(e.barPadding),k=b.scaleLinear().rangeRound([h,0]),E=b.scaleLinear().rangeRound([h,0]),B=b.scaleBand().rangeRound([0,O]).padding(e.barPadding),P=b.line().x((function(t,e){return B(p.x[e])||0})).y((function(t,e){return h-t.p*h/100-20})),S=function(t,e){return 0!==e&&t&&t?100*t+"%":""},V=p.p.map((function(t,e){return{x:p.x[e]||"",p:t||0}}))||null,N=p.p.map((function(t,e){return{x:p.x[e]||"",p:u}}))||null,R=p.p[0]/p.p.length,T=!1;return j.domain(p.x),k.domain([m-R,d+R]),B.domain(p.x),x.a.createElement("div",{className:Object(y.cx)(i.wrapper,Object(y.css)(l||(l=s(["\n          width: ","px;\n          height: ","px;\n        "],["\n          width: ","px;\n          height: ","px;\n        "])),r,a))},x.a.createElement("svg",{className:i.svg,width:r,height:a,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 "+r+" "+a},x.a.createElement("g",{transform:"translate(20, 20)",className:"wrapper"},x.a.createElement("g",{className:"bars",transform:"translate(20, 0)"},p.y.map((function(t,e){var n=j(p.x[e])||0;return x.a.createElement(x.a.Fragment,null,x.a.createElement("rect",{x:n,y:k(t),width:j.bandwidth(),height:h-k(t),fill:p.p[e]>u?o.palette.redBase:o.palette.greenBase}),x.a.createElement(x.a.Fragment,null,p.p[e]>u&&c&&!T&&(T=!0,!0)&&x.a.createElement("line",{className:i.lineCutOff,transform:"translate(0, 0)",ref:function(t){b.select(t).attr("x1",n+j.bandwidth()/2).attr("x2",n+j.bandwidth()/2).attr("y1",0).attr("y2",h)}})))}))),x.a.createElement("g",{className:i.paths},x.a.createElement("path",{className:i.line,transform:"translate("+(20+j.bandwidth()/2)+", 20)",ref:function(t){b.select(t).datum(V).attr("d",(function(t){return P(t)}))}}),c&&x.a.createElement("path",{className:i.lineCutOff,transform:"translate("+(20+j.bandwidth()/2)+", 20)",ref:function(t){b.select(t).datum(N).attr("d",(function(t){return P(t)}))}})),x.a.createElement("g",{className:"axis"},f&&x.a.createElement("g",{transform:"translate(20, "+h+")",ref:function(t){b.select(t).call(b.axisBottom(j))}}),x.a.createElement("g",{transform:"translate(20, 0)",ref:function(t){b.select(t).call(b.axisLeft(k))}}),x.a.createElement("g",{transform:"translate("+(O+20)+", 0)",ref:function(t){b.select(t).call(b.axisLeft(E).ticks(5).tickFormat(S))}})))))})).setPanelOptions((function(t){return t.addBooleanSwitch({path:"showBottomAxis",name:"Show bottom axis?",defaultValue:!1}).addBooleanSwitch({path:"showVitalFew",name:"Show vital few line?",defaultValue:!0}).addNumberInput({path:"vitalBreakpointVal",name:"Vital few value (%)",defaultValue:80}).addNumberInput({path:"barPadding",name:"Bar padding",defaultValue:.2})}))}])}));
//# sourceMappingURL=module.js.map